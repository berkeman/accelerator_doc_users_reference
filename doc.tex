%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                          %
% Copyright (c) 2018 eBay Inc.                                             %
%                                                                          %
% Licensed under the Apache License, Version 2.0 (the "License");          %
% you may not use this file except in compliance with the License.         %
% You may obtain a copy of the License at                                  %
%                                                                          %
%  http://www.apache.org/licenses/LICENSE-2.0                              %
%                                                                          %
% Unless required by applicable law or agreed to in writing, software      %
% distributed under the License is distributed on an "AS IS" BASIS,        %
% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. %
% See the License for the specific language governing permissions and      %
% limitations under the License.                                           %
%                                                                          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% HOW TO BUILD                                                             %
% needs "apt-get cm-super" on debian to embed pdf fonts correctly          %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper]{book}
\usepackage{graphicx}
\usepackage{color}
\usepackage[T1]{fontenc}

\setlength{\textwidth}{140mm}
\setlength{\oddsidemargin}{0mm}
\setlength{\evensidemargin}{0mm}
\setlength{\textheight}{250mm}
\setlength{\voffset}{-20mm}
%\usepackage{showframe}

\usepackage{xspace}
\usepackage{fancybox}
\usepackage{framed}

% watermark
\usepackage{draftwatermark}
\SetWatermarkText{DRAFT}
\SetWatermarkScale{4}
\SetWatermarkLightness{0.95}

% comment macro
\definecolor{readercomment}{rgb}{1.0,0.0,0.0}
\newcommand{\comment}[1]{\emph{\textcolor{readercomment}{\fbox{#1}}}}

%%%  Various reserved words  %%%
\newcommand{\joblist}{\texttt{JobList}\xspace}
\newcommand{\jobids}{\texttt{jobids}\xspace}
\newcommand{\datasets}{\texttt{datasets}\xspace}
\newcommand{\options}{\texttt{options}\xspace}
\newcommand{\prepare}{\texttt{prepare}\xspace}
\newcommand{\analysis}{\texttt{analysis}\xspace}
\newcommand{\synthesis}{\texttt{synthesis}\xspace}
\newcommand{\analysisres}{\texttt{analysis\_res}\xspace}
\newcommand{\prepareres}{\texttt{prepare\_res}\xspace}
\newcommand{\params}{\texttt{params}\xspace}

% minted Python
\usepackage{minted, xcolor}
\usemintedstyle{lovelace}
\definecolor{bg}{rgb}{0.95,0.95,0.95}
\definecolor{bg_shell}{rgb}{0.95,0.95,1.00}
\definecolor{hl}{rgb}{1.00,1.00,0.80}
\newminted[python]{python}{bgcolor=bg, escapeinside=||}

% Common Python tokens
\newcommand{\pyNone}{\mintinline{python}/None/\xspace}
\newcommand{\pyTrue}{\mintinline{python}/True/\xspace}
\newcommand{\pyFalse}{\mintinline{python}/False/\xspace}

% minted Shell
\newminted[shell]{bash}{}



\newlength{\onechartt}
\settowidth{\onechartt}{\texttt{0}}
\newcommand\inputfile[1]{% could be prettier, indeed!
    \InputIfFileExists{#1}{}{\typeout{No file #1.}}\hspace{-\onechartt}%
}


% Table macros
\definecolor{shadecolor}{rgb}{0.96,0.96,0.96}
% table with three columns
\def\starttable{%
  \begin{snugshade}
    \noindent\begin{tabular}{@{}p{3.2cm}p{1.8cm}p{8cm}}\hline\\[-1ex]
      \textbf{name} & \textbf{default} & \textbf{description}\\[1ex]
      \hline\\[1ex]}
\def\stoptable{\\[1ex]\hline\end{tabular}\end{snugshade}}
\def\RP #1&#2&#3{ #1&#2&#3}

% table with two columns
\def\starttabletwo{%
  \begin{snugshade}
    \noindent\begin{tabular}{@{}p{5.0cm}p{8cm}}\hline\\[-1ex]
      \textbf{name} & \textbf{description}\\[1ex]
      \hline\\[1ex]}
\def\stoptabletwo{\\[1ex]\hline\end{tabular}\end{snugshade}}
\def\RPtwo #1&#2{ #1&#2}


%\includeonly{urd}


\begin{document}

\begin{center}
  \vspace*{1.0cm}
  {\Huge The Accelerator}\\[0.7cm]
  {\Large User's Reference}\\[0.5cm]
  {\large Version 0.9, 2018-05-28, \textbf{draft}}
  \vspace{1.3cm}
  \begin{figure}[h]
    \centering
    \includegraphics[width=11cm]{odhner_square_100dpi.jpg}
  \end{figure}
  \vfill
  { Anders Berkeman, Carl Drougge, and Sofia H\"orberg}\\
  {\tiny{version: \inputfile{gitrevision}}}
\end{center}
\thispagestyle{empty}


\newpage
\thispagestyle{empty}
\section*{Document History}

\begin{tabular}{rrp{8cm}}
version & description\\[0.75ex]
   --, \texttt{772990f4} & 2018-04-23 & First open version.\\
  0.9, \texttt{\inputfile{gitrevision}} & 2018-05-28 & Updated parts of Urd chapters.\\
\end{tabular}


\newpage
\tableofcontents

\chapter{Introduction}
\include{introduction}

\chapter{Overview}
\include{overview}

\chapter{Basic Build Scripting}
\include{urd_basic}

\chapter{High Level Control:  Urd}
\include{urd}

\chapter{Jobs}
\include{method}

\chapter{Datasets}
\include{dataset}

\chapter{Iterators}
\include{iterator}

\chapter{Standard Methods}
The Accelerator is shipped with a set of common standard methods.
These are found in the method directory \texttt{./standard\_methods}.
\include{standard_methods}

\chapter{Command Line Tools}
\include{tools}

\appendix

\chapter{Practicalities}
\include{practicalities}

% chapter habitatiii?

% chapter installation?

% chapter examples?

% references

\end{document}
